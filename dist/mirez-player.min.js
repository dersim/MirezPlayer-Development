(function(a){"function"==typeof define&&define.amd?define(a):a()})(function(){'use strict';function a(b){"@babel/helpers - typeof";return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},a(b)}function b(a){function b(b){return 0===a.indexOf(b)}return a=new String(a),{startsWith:b}}function c(d,f,e){function g(){if(4===i.readyState){var a=b(i.status);return a.startsWith(30)?new c(d,f,e):200===i.status?void f(!1,i):f(i,{})}}function h(){i&&(i.open("GET",d,!0),i.timeout=2e3,i.ontimeout=function(){console.log("timeout")},i.responseType=e.responseType||"",f&&(i.onerror=function(a){f(a,{})},i.onreadystatechange=g),i.send())}if(d=d||!1,f=f||!1,e=e||{},e.followRedirects=void 0===a(e.followRedirects)||e.followRedirects,!1!==d){var i=new XMLHttpRequest;i.withCredentials=e.withCredentials||!1,i.requestContentType=e.requestContentType||null,h()}}function d(a){l()("TOnlineMediplayer","VASTParser","Event",a.name,a.url),o(a.url)}function e(a){var b=a.contentWindow&&a.contentWindow.document;return!!b&&b}function f(a,b,c,d,f){var g=document.createElement("iframe");g.href="about:blank",g.setAttribute("style","height:1px;width:1px;border:0 none;position:absolute;top:-10px;left:-10px;"),g.id="VPAIDAdLoaderFrame"+Date.now();document.body.appendChild(g);var h=e(g);h.write("<!DOCTYPE html+><head><title></title></head><body><script src=\""+a+"\"></script><script>__LOADED=true;</script></body></html>"),function(){var a=g.contentWindow;v(a,function(a,e){if(a)return void l("error")("MirezPlayer","VPAIDUtils",a,e);l()("Mirez-Player","VPAIDUtils","VPAID is",e),l()("Mirez-Player","VPAIDUtils","VPAID currentAd",b),e.on=function(a,b){this.subscribe(b,a)},e.on("AdError",function(a){l("error")("Mirez-Player","VPAIDUtils","VPAID onAdError:",a);d.userEventListeners.adError.forEach(function(b){b(405,s[405],a)}),l("error")("Mirez-Player","VPAIDUtils",s[405],a)}),e.on("AdLoaded",function(){l()("Mirez-Player","VPAIDUtils","VPAID onInit"),c.hideLoader(),c.showVPAIDArea(),c.showSoundIcon(),c.setSoundOn(),e.startAd()}),e.on("AdSkipped",function(){l()("Mirez-Player","VPAIDUtils","VPAID Ad skipped")}),e.on("AdStopped",function(){l()("Mirez-Player","VPAIDUtils","VPAID Ad stop")}),e.on("AdVideoComplete",function(){l()("Mirez-Player","VPAIDUtils","VPAID onVideoComplete")}),e.on("AdClickThru",function(a,b,c){c&&window.open(a),f.clickTrackings.forEach(function(a){l()("Mirez-Player","VPAIDUtils","Event","ClickThru ClickTracking",a),o(a)})});var g="",h=b.querySelector("AdParameters");h&&(g=h.textContent),l()("Mirez-Player","VPAIDUtils","VPAID adParams",g),e.initAd(c.getWidth(),c.getHeight(),"normal",-1,{AdParameters:g},{slot:c.getVPaidArea(),videoSlot:c.getVideoEl(),videoSlotCanAutoPlay:!1})})}()}function g(a){function b(a,b){var d,c=Math.abs,e=0,f=1e3;for(e in a){var g=c(b-a[e]);g<f&&(f=g,d=a[e])}return d}a=a||{};var d=a.playerMethod,e=a.playerDataStore,f=a;f.maxRedirect=10;var g={},j=[],k=[],s=[],t={errors:[],impressions:[],creatives:[]};g.Reset=function(){j=[],k=[],s=[],t={errors:[],impressions:[],creatives:[]}};var u=function(a){if(!a)return null;var c=function(){var b=a.querySelectorAll("MediaFiles MediaFile");return b?(b.forEach(function(a){s.push({src:a.textContent||a.src||"",delivery:a.getAttribute("delivery")||null,type:a.getAttribute("type")||null,width:a.getAttribute("width")||null,bitrate:a.getAttribute("bitrate")||null,height:a.getAttribute("height")||null})}),s):s},d=function(a,c){l()("Mirez-Player","VASTParser","Get closest media file based on "+a+":",c);var d,e=null,f=0,g=s.length,h=[];for(f=0;f<g;f++)d=s[f],-1!==d.type.indexOf("mp4")&&h.push(parseInt(d[a],10));var j=null;return j=b(h,c),s.forEach(function(b){return"application/javascript"===b.type?(e=b,!1):-1!==b.type.indexOf("mp4")&&parseInt(b[a],10)===j?(e=b,!1):void 0}),l()("Mirez-Player","VASTParser","Selected media file:",e),e};return{GetMediaFiles:c,GetMediaFileClosestTo:d}};return g.Parse=function(b,c){var h=b.documentElement,s=h.querySelector("Wrapper"),v=h.querySelectorAll("Error"),x=h.querySelectorAll("AdVerifications Verification"),y=h.querySelectorAll("Impression"),z=h.querySelectorAll("Impressions"),A=h.querySelectorAll("ClickTracking"),B=h.querySelectorAll("TrackingEvents Tracking");if(null!==b){var C=f.maxRedirect--;l()("Mirez-Player","VASTParser",C+" VAST URL: ",c),l()("Mirez-Player","VASTParser","VAST Document:",b.cloneNode(!0))}else g.Reset();if(v&&v.length&&(v.forEach(function(a){t.errors.push(a.textContent)}),l()("Mirez-Player","VASTParser","Error Pixel: ",t.errors)),(y&&y.length||z&&z.length)&&(y.forEach(function(a){a.textContent&&a.textContent.length&&t.impressions.push(a.textContent)}),l()("Mirez-Player","VASTParser","Impression Pixel: ",t.impressions)),A&&(A.forEach(function(a){k.push(m(a))}),l()("Mirez-Player","VASTParser","Click Tracking: ",k)),j.push(n(B)),l()("Mirez-Player","VASTParser"," Tracking Events: ",j),0<x.length);if(!s){l()("Mirez-Player","VASTParser"," Finish: ","Wrapper End");var D=h.querySelectorAll("Creatives Creative");if(0===D.length)return void g.Reset();var E=null,F=null;if(D.forEach(function(b){if(b.querySelector("Linear")){F=b.querySelector("Linear");var c=F.querySelector("ClickThrough");if(c){var f=a.playerMethod.getLandingPageArea(),g=i;g=function(){try{q(d,e.userEventListeners,"adClick")}catch(a){l("Error")("Mirez-Player","VASTParser","UserEventListenerException",a)}k.forEach(function(a){l()("Mirez-Player","VASTParser","ClickTracking",a),o(a)}),l()("Mirez-Player","VASTParser","ClickThrough",c),window.open(m(c))},f.addEventListener("click",g)}E=u(F),l()("Mirez-Player","VASTParser","Possible media files:",E.GetMediaFiles())}}),E){r(d,e),j.forEach(function(a){p(a,d)});var G=a.playerMethod.getVideoEl(),H=E.GetMediaFileClosestTo("height",a.playerMethod.getHeight());if("application/javascript"===H.type)return l()("Mirez-Player","VASTParser","Linear Node:",F),w.LoadAdUnit(H.src,F,d,e,{clickTrackings:k}),t.impressions.forEach(function(a){l()("Mirez-Player","VASTParser","Impression fired",a),o(a)}),void l()("Mirez-Player","VASTParser","Collected Items:",t);G.src=H.src,a.playerMethod.hideLoader(),a.playerMethod.showPlayIcon(),a.playerMethod.showAdIsPlaying("preroll")}return}var I=s.querySelector("VASTAdTagURI").textContent;I&&g.Read(I)},g.Read=function(a){var b=h(a);new c(b,function(a,c){a||new g.Parse(c.responseXML,b)},{requestContentType:"document"})},g}"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(a,b){b=b||window;for(var c=0;c<this.length;c++)a.call(b,this[c],c,this)});var h=function(a){if(-1!==a.indexOf("[TIMESTAMP]")){var b=Date.now();a=a.replace("[TIMESTAMP]",b)}if(-1!==a.indexOf("%%CACHEBUSTER%%")){var c=Date.now();a=a.replace("%%CACHEBUSTER%%",c)}if(-1!==a.indexOf("[CACHEBUSTER]")){var d=Date.now();a=a.replace("[CACHEBUSTER]",d)}return a},i=function(){},j=!!window.MSInputMethodContext&&!!document.documentMode,l=function(b){if(null===localStorage.getItem("MirezPlayerDebug"))return i;b=b||"info";var d,e={info:{bg:"#19cf85",fg:"#272b30"},warn:{bg:"#ffd866",fg:"#272b30"},debug:{bg:"#3c92d1",fg:"#272b30"},error:{bg:"#ff6188",fg:"#272b30"}};return d=!1==b in e?"object"===a(b)?{fg:b.fg||"#777",bg:b.bg||"transparent"}:e.info:e[b],function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),e=1;e<b;e++)c[e-1]=arguments[e];if(j){var f;(f=window.console).log.apply(f,[a].concat(c))}else{var g;(g=window.console).log.apply(g,["%c"+a,"color:"+d.fg+";background:"+d.bg+";"].concat(c))}}},m=function(a){return a.nodeValue||a.textContent},n=function(a){var b,c,d=[];return 0===a.length?d:(a.forEach(function(a){b=a.getAttribute("event"),c={name:b,url:m(a)},"progress"===b&&(c.offset=a.getAttribute("offset")),d.push(c)}),d)},o=function(a,b,c){function d(){i.parentNode.removeChild(i)}function e(){b(!1,i),d()}function f(){b("Error",i),d()}function g(){b("Abort",i),d()}function h(){i&&(b&&(i.onerror=f,i.onabort=g,i.onload=e),c.parent.appendChild(i))}if(a=a||!1,b=b||function(){},c=c||{},c.parent=c.parent||document.body,!1!==a){var i=document.createElement("img");i.src=a,h()}},p=function(a,b){var c=b.getVideoEl(),e=[],f=[];a.forEach(function(a){var b=function b(){c.removeEventListener("play",b),d(a)};switch(a.name){case"start":c.addEventListener("play",b);}});var g=function(){if(0<e.length)for(var a=null,b=e.length;b--;)a=e[b],c.currentTime>=a.time()&&(a.callback(),e.splice(b,1))};c.addEventListener("timeupdate",g);c.addEventListener("ended",function a(){c.removeEventListener("timeupdate",g),f.forEach(function(a){c.removeEventListener(a.event,a.func)}),c.removeEventListener("ended",a)})},q=function(a,b,c,d){console.log("triggerUEL"),console.log(a),console.log(b),console.log(c),console.log(b[c]),d=d||null,b[c]&&b[c].length&&b[c].forEach(function(b){b(d,a,c)})},r=function(a,b){var c=a.getVideoEl(),d=b.userEventListeners;[{name:"start"}].forEach(function(b){var e=function(){!a.isPlayingAd()||1<c.currentTime||q(a,d,"adStart")};switch(b.name){case"start":c.addEventListener("play",e);}})},s={100:"XML Parsing Error.",101:"VAST schema validation error.",102:"VAST version of response not supported.",200:"Trafficking error. Media player received an Ad type that it was not expecting and/or cannot play.",201:"Media player expecting different linearity.",202:"Media player expecting different duration.",203:"Media player expecting different size.",204:"Ad category was required but not provided.",205:"Inline Category violates Wrapper BlockedAdCagetories (refer 3.19.2).",206:"Ad Break shortened. Ad was not served.",300:"General Wrapper error.",301:"Timeout of VAST URI provied in Wrapper element, or of VAST URI provied in a subsequent Wrapper element. (URI was either unavailable or reached a timeout as defined by the media player.)",302:"Wrapper limit reached, as defined by the media player. Too many Wrapper responses have been received with no InLine response.",303:"No VAST response after one or more Wrappers.",304:"InLine response returned ad unit that failed to result in ad display withing defined time limit.",400:"General Linear error. Media player is unable to display the Linear Ad.",401:"File not found. Unable to find Linear/MedaFile from URI.",402:"Timeout of MediaFile URI.",403:"Could't find MediaFile that is supported by this media player, based on the attributes of the MediaFile element.",405:"Problem displaying MediaFile. Media player found a MediaFile with supported type but couldn't display it. MediaFile may include: unsupported codecs, different MIME type than MediaFile@type, unsupported delivery method, etc.",900:"Undefined Error.",901:"General VPAID error.",902:"General InteractiveCreativeFile error code"},t=null,u=function(a){return!!(a.handshakeVersion&&"function"==typeof a.handshakeVersion&&a.initAd&&"function"==typeof a.initAd&&a.startAd&&"function"==typeof a.startAd&&a.stopAd&&"function"==typeof a.stopAd&&a.skipAd&&"function"==typeof a.skipAd&&a.resizeAd&&"function"==typeof a.resizeAd&&a.pauseAd&&"function"==typeof a.pauseAd&&a.resumeAd&&"function"==typeof a.resumeAd&&a.expandAd&&"function"==typeof a.expandAd&&a.collapseAd&&"function"==typeof a.collapseAd&&a.subscribe&&"function"==typeof a.subscribe&&a.unsubscribe&&"function"==typeof a.unsubscribe)},v=function a(b,d){var e=b.__LOADED;if(d=d||i,e&&!0===e){var c=b.getVPAIDAd;c&&"function"==typeof c?(t=c(),u(t)?d(!1,t):d("No valid VPAID",{})):l("error")("Mirez-Player","VPAIDUtils","iframe has been fully loaded, but getVPAIDAd is not a fn, but this:",c)}else setTimeout(function(){a(b,d)},200)},w={LoadAdUnit:function(a,b,c,d,e){l("error")("Mirez-Player","VPAIDUtils","Loading VPAID URL:",a),f(a,b,c,d,e)}},x=function(a){return a=a||{},a.playerMethod.getPreRollTag()?void(a.vastParser=new g({playerMethod:a.playerMethod,playerDataStore:a.playerDataStore}),a.vastParser.Read(a.playerMethod.getPreRollTag())):console.log("VAST Tag is not present")},y=function(){function a(){return!!(window.navigator.userAgent.match(/Tablet/i)||window.navigator.userAgent.match(/iPad/i)||window.navigator.userAgent.match(/Nexus 7/i)||window.navigator.userAgent.match(/Nexus 10/i)||window.navigator.userAgent.match(/KFAPWI/i))&&(document.body.className-=" mobile",document.body.className+=" tablet",!0)}return window.onload=a,a()},z=function(){return!!window.matchMedia("(pointer: coarse)").matches&&!0!==y()},A=function(a){var b=this;l()("Mirez-Player","VASTPlayer","DOMNode",a);var c=this,d={el:a,videoEl:a.querySelector("video"),contentEl:a.querySelector(".mirez-content"),loader:a.querySelector(".mirez-loader"),landingPageArea:a.querySelector(".landing-page-area"),playIcon:a.querySelector(".play-icon-area"),soundIcon:a.querySelector(".mirez-sound-area"),soundAnimIcon:a.querySelectorAll(".mirez-sound-icon"),vpaidArea:a.querySelector(".vpaid-area"),vastIsParsed:!1,isFirstStart:!0,isPlayingAd:!1,defaultPlaybackRateForAds:1,userEventListeners:{adStart:[],adClick:[],adLoaded:[],adError:[],firstStart:[],play:[],pause:[],contentVideoResume:[]},prerollTag:a.getAttribute("preroll-tag")};this.getEl=function(){return d.el},this.getPreRollTag=function(){return d.prerollTag},this.getVideoEl=function(){return d.videoEl},this.getLoader=function(){return d.loader},this.getLandingPageArea=function(){return d.landingPageArea},this.getPlayIcon=function(){return d.playIcon},this.getSoundIcon=function(){return d.soundIcon},this.getSoundAnimIcon=function(){return d.soundAnimIcon},this.getVPaidArea=function(){return d.vpaidArea},this.getHeight=function(){return d.el.offsetHeight},this.getWidth=function(){return d.el.offsetWidth},this.getCurrentTime=function(){return Math.floor(d.videoEl.currentTime)},this.setVastIsParsed=function(){return d.vastIsParsed=!0},this.setDefaultPlaybackRateForAds=function(){return b.getVideoEl().playbackRate=d.defaultPlaybackRateForAds,b.getVideoEl().defaultPlaybackRate=d.defaultPlaybackRateForAds,b},this.setAnimSound=function(){b.getSoundAnimIcon()[0].classList.remove("none"),b.getSoundAnimIcon()[1].classList.remove("none"),b.getSoundAnimIcon()[2].classList.remove("none")},this.setAnimSoundNone=function(){b.getSoundAnimIcon()[0].classList.add("none"),b.getSoundAnimIcon()[1].classList.add("none"),b.getSoundAnimIcon()[2].classList.add("none")},this.setSoundOn=function(){return d.videoEl.muted=!0},this.setSoundOff=function(){return d.videoEl.muted=!1},this.isPaused=function(){return d.videoEl.paused},this.isPlayingAd=function(){return d.isPlayingAd},this.isFirstStart=function(){return d.isFirstStart},this.hideLoader=function(){b.getLoader().classList.remove("show"),b.getLoader().classList.add("hide")},this.showLoader=function(){b.getLoader().classList.remove("hide"),b.getLoader().classList.add("show")},this.hidePlayIcon=function(){b.getPlayIcon().classList.remove("show"),b.getPlayIcon().classList.add("hide")},this.showPlayIcon=function(){b.getPlayIcon().classList.remove("hide"),b.getPlayIcon().classList.add("show")},this.showAdIsPlaying=function(a){b.setDefaultPlaybackRateForAds(),d.isPlayingAd=!0,b.getEl().classList.add("playing-ad"),a&&b.getEl().classList.add("ad-"+a)},this.hideSoundIcon=function(){b.getSoundIcon().classList.remove("show"),b.getSoundIcon().classList.add("hide")},this.showSoundIcon=function(){b.getSoundIcon().classList.remove("hide"),b.getSoundIcon().classList.add("show")},this.hideLandingPageArea=function(){b.getLandingPageArea().classList.remove("show"),b.getLandingPageArea().classList.add("hide")},this.showLandingPageArea=function(){b.getLandingPageArea().classList.remove("hide"),b.getLandingPageArea().classList.add("show"),z()?b.getLandingPageArea().classList.add("mobile"):b.getLandingPageArea().classList.add("desktop")},this.hideVPAIDArea=function(){b.getVPaidArea().classList.remove("show"),b.getVPaidArea().classList.add("hide")},this.showVPAIDArea=function(){b.getVPaidArea().classList.remove("hide"),b.getVPaidArea().classList.add("show")},c.getVideoEl().addEventListener("play",function(a){d.userEventListeners.play.forEach(function(b){b(a,c,"play")}),!0===c.isFirstStart()&&(d.userEventListeners.firstStart.forEach(function(b){b(a,c,"firstStart")}),console.log("FirstStart")),!1!==c.isPlayingAd()&&0<c.getCurrentTime()&&(d.userEventListeners.contentVideoResume.forEach(function(b){b(a,c,"contentVideoResume")}),console.log("contentVideoResume")),d.isFirstStart=!1}),this.addEvent=function(){var a=this,b=d.videoEl,c=d.contentEl;c.addEventListener("click",function(c){c.preventDefault();var d=c.target;switch(d.getAttribute("data-clicktarget")){case"click-play":a.hidePlayIcon(),a.showLandingPageArea(),a.showSoundIcon(),b.play();break;case"click-landing-page":a.showPlayIcon(),a.hideLandingPageArea(),a.hideSoundIcon(),b.pause();break;case"click-sound":!0===b.muted?(b.muted=!1,a.setAnimSoundNone()):(b.muted=!0,a.setAnimSound());}})},this.parsingVastTag=function(){c.showLoader(),!0===c.isPaused()&&!1===d.vastIsParsed&&x({playerMethod:c,playerDataStore:d})},c.parsingVastTag(),c.addEvent()},B=function(){var a={};return a.enableDebugMode=function(){return window.localStorage.setItem("MirezPlayerDebug",1)},a.disableDebugMode=function(){return window.localStorage.removeItem("MirezPlayerDebug")},a.initVASTPlayer=function(){var a=document.querySelector(".mirez-player"),b=new A(a);return b},a.Init=function(){a.initVASTPlayer()},a};(function(){window.mirezplayer=new B})()});